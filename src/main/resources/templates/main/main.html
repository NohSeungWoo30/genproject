<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<!--<html lang="ko" xmlns:th="http://www.w3.org/1999/xhtml">-->
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!--í† ìŠ¤íŠ¸(ìš°ì¸¡í•˜ë‹¨ ì‹¤ì‹œê°„ ì•Œë¦¼) ì¶”ê°€ ëª¨ë“  í˜ì´ì§€ì— ê¼­ ì¶”ê°€í•˜ê¸°-->
    <link rel="stylesheet" href="/css/toast.css" />
    <!--ì•Œë¦¼(ì¢…ëª¨ì–‘)ê¸°ëŠ¥ cssì¶”ê°€ ì•Œë¦¼ê¸°ëŠ¥ì´ í¬í•¨ë˜ëŠ” ëª¨ë“  ê³³ì— ì¶”ê°€í•˜ê¸°-->
    <link rel="stylesheet" href="/css/notify.css" />
    <link rel="stylesheet" href="/css/mainstyle.css" />
    <link rel="stylesheet" href="/css/meetingdetail.css" />
    <link rel="stylesheet" href="/css/filter.css" />

    <!--ë¡œê·¸ì¸ ì„¸ì…˜ê´€ë ¨ ê³„ì† ì¶”ê°€í•˜ê¸°-->
    <th:block th:replace="fragments/user-session :: sessionScript"></th:block>

    <!-- 1. í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬: SockJS, STOMP -->
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>


    <title>ë©”ì¸ í˜ì´ì§€</title>

    <!-- ===== ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ===== -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <!-- ionicons: main, simple ë‘˜ ë‹¤ í•„ìš” -->
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
    <!-- noUiSlider: simple.htmlìš© -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nouislider@15.7.0/dist/nouislider.min.css">
    <script src="https://cdn.jsdelivr.net/npm/nouislider@15.7.0/dist/nouislider.min.js"></script>

</head>

<body>
<div class="_1920-w-light">

    <!-- â”€â”€â”€ ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ â”€â”€â”€ -->
    <header class="container-nav">
        <div class="nav-left">
            <a th:href="@{/main}"><img class="logo" src="/img/icons/Group 17.png" alt="M ë¡œê³ "></a>
        </div>

        <div class="nav-center">
            <img src="/img/ë´„.png" class="nav-img" alt="ê·¸ë¦¼10">
            <img src="/img/ì—¬ë¦„.png" class="nav-img" alt="ê·¸ë¦¼10">
            <img src="/img/ê°€ì„.png" class="nav-img" alt="ê·¸ë¦¼10">
            <img src="/img/ê²¨ìš¸.png" class="nav-img" alt="ê·¸ë¦¼10">
        </div>

        <!-- ** navRight: ë¡œê·¸ì¸/ì•Œë¦¼/í”„ë¡œí•„ ì˜ì—­(ë™ì ) ** -->
        <div class="nav-right" id="navRight">
            <a href="/user/login" class="login-link">ë¡œê·¸ì¸ã†íšŒì›ê°€ì…</a>
        </div>
    </header>

    <!-- â”€â”€â”€ í•˜ë‹¨ ê³ ì • ë„¤ë¹„ (ëª¨ë°”ì¼ bottomâ€‘nav ìŠ¤íƒ€ì¼) â”€â”€â”€ -->
    <section class="bottom-nav-wrapper">
        <nav class="bottom-nav">
            <a th:href="@{/group/create}" class="bottom-link">ëª¨ì„ ìƒì„±</a>
            <a th:href="@{/group/meetinglist}" class="bottom-link">ëª¨ì„ ëª©ë¡</a>
            <a th:href="@{/product-list}" class="bottom-link">ìƒí’ˆ ëª©ë¡</a>
            <a th:href="@{/posts}" class="bottom-link">ììœ  ê²Œì‹œíŒ</a>
        </nav>
    </section>

    <!-- â”€â”€â”€ ë©”ì¸ ë°°ë„ˆ â”€â”€â”€ -->
    <section class="main-banner">
        <div class="banner-slide-wrapper">
            <img src="/img/ê³ ê¸°.png" class="banner-image" />
            <img src="/img/ì½˜ì„œíŠ¸.png" class="banner-image" />
            <img src="/img/ëŸ¬ë‹.png" class="banner-image" />
        </div>
        <button class="banner-prev">â†</button>
        <button class="banner-next">â†’</button>
    </section>

    <!-- â”€â”€â”€ ì¹´í…Œê³ ë¦¬ ì•„ì´ì½˜ ë§í¬ â”€â”€â”€ -->
    <nav class="category-links">
        <a href="group/meetinglist?mainCategoryId=1" class="cat-link">
            <img src="/img/icons/ball1.png" alt="ìš´ë™/ì•¡í‹°ë¹„í‹° ì•„ì´ì½˜" class="cat-icon" />
            <span class="cat-text">ìš´ë™/ì•¡í‹°ë¹„í‹°</span>
        </a>

        <a href="group/meetinglist?mainCategoryId=2" class="cat-link">
            <img src="/img/icons/art1.png" alt="ë¬¸í™”/ì˜ˆìˆ  ì•„ì´ì½˜" class="cat-icon" />
            <span class="cat-text">ë¬¸í™”/ì˜ˆìˆ </span>
        </a>

        <a href="group/meetinglist?mainCategoryId=3" class="cat-link">
            <img src="/img/icons/book1.png" alt="ì§€ì‹/ìŠ¤í„°ë”” ì•„ì´ì½˜" class="cat-icon" />
            <span class="cat-text">ì§€ì‹/ìŠ¤í„°ë””</span>
        </a>

        <a href="group/meetinglist?mainCategoryId=4" class="cat-link">
            <img src="/img/icons/food1.png" alt="ìŒì‹/ì¹´í˜ ì•„ì´ì½˜" class="cat-icon" />
            <span class="cat-text">ìŒì‹/ì¹´í˜</span>
        </a>

        <a href="group/meetinglist?mainCategoryId=5" class="cat-link">
            <img src="/img/icons/travel1.png" alt="ì—¬í–‰/íƒí—˜ ì•„ì´ì½˜" class="cat-icon" />
            <span class="cat-text">ì—¬í–‰/íƒí—˜</span>
        </a>

        <a href="group/meetinglist?mainCategoryId=6" class="cat-link">
            <img src="/img/icons/game1.png" alt="ê²Œì„/ì˜¤ë½ ì•„ì´ì½˜" class="cat-icon" />
            <span class="cat-text">ê²Œì„/ì˜¤ë½</span>
        </a>

        <a href="group/meetinglist?mainCategoryId=7" class="cat-link">
            <img src="/img/icons/game1.png" alt="ê²Œì„/ì˜¤ë½ ì•„ì´ì½˜" class="cat-icon" />
            <span class="cat-text">ë°˜ë ¤ë™ë¬¼/ìì—°</span>
        </a>

        <a href="group/meetinglist?mainCategoryId=8" class="cat-link">
            <img src="/img/icons/build1.png" alt="ë§Œë“¤ê¸°/ê³µì˜ˆ ì•„ì´ì½˜" class="cat-icon" />
            <span class="cat-text">ë§Œë“¤ê¸°/ê³µì˜ˆ</span>
        </a>

        <a href="group/meetinglist?mainCategoryId=9" class="cat-link">
            <img src="/img/icons/social3.png" alt="ì†Œì…œ/ì¹œëª© ì•„ì´ì½˜" class="cat-icon" />
            <span class="cat-text">ì†Œì…œ/ì¹œëª©</span>
        </a>

        <a href="group/meetinglist?mainCategoryId=10" class="cat-link">
            <img src="/img/icons/guitar1.png" alt="ê¸°íƒ€ ì•„ì´ì½˜" class="cat-icon" />
            <span class="cat-text">ê¸°íƒ€</span>
        </a>
    </nav>

    <!-- â”€â”€â”€ ìµœì‹  ëª¨ì„ (ê°€ë¡œ ìŠ¤í¬ë¡¤ ì¹´ë“œ) â”€â”€â”€ -->
    <section class="container2">
        <span>ìµœê·¼ ìƒì„± ëª¨ì„</span>
        <div class="flex-row">
            <!-- 1 ìµœê·¼ ìƒì„± ëª¨ì„ -->
            <div th:each="gd_group : ${groupByCreateDate}" th:data-group-idx="${gd_group.groupIdx}" class="card">
                <div class="card-thumb">
                    <img th:if="${gd_group.groupImgUrl != null and !#strings.isEmpty(gd_group.groupImgUrl)}"
                         th:src="@{${gd_group.groupImgUrl}}" />
                    <img th:unless="${gd_group.groupImgUrl != null and !#strings.isEmpty(gd_group.groupImgUrl)}"
                         th:src="@{/img/noImage.jpg}" />
                </div>
                <div class="card-info">
                    <div class="card-category">
                        <span th:text="${gd_group.district}"></span> Â· <span th:text="${gd_group.categoryMain.categoryMainName}"></span>
                    </div>
                    <div class="card-title" th:text="${gd_group.title}">
                    </div>
                    <div class="card-date" th:text="${#temporals.format(gd_group.groupDate, 'yyyy.MM.dd(E) HH:mm')}"></div>
                </div>
            </div>
        </div>
    </section>

    <section class="container2">
        <span>í™œë°œí•œ ëª¨ì„(ì§€ì—­)</span>
        <div class="flex-row">
            <!-- 2 ì¹´í…Œê³ ë¦¬ê°€ ë§ì€ ì¸ê¸° ëª¨ì„ìˆœ -->
            <div th:each="groupCategory : ${groupByCategory}" th:data-group-idx="${groupCategory.groupIdx}" class="card">
                <div class="card-tzhumb">
                    <img th:if="${groupCategory.groupImgUrl != null and !#strings.isEmpty(groupCategory.groupImgUrl)}"
                         th:src="@{${groupCategory.groupImgUrl}}" />
                    <img th:unless="${groupCategory.groupImgUrl != null and !#strings.isEmpty(groupCategory.groupImgUrl)}"
                         th:src="@{/img/noImage.jpg}" />
                </div>
                <div class="card-info">
                    <div class="card-category">
                        <span th:text="${groupCategory.district}"></span> Â· <span th:text="${groupCategory.categoryMain.categoryMainName}"></span>
                    </div>
                    <div class="card-title" th:text="${groupCategory.title}">
                    </div>
                    <div class="card-date" th:text="${#temporals.format(groupCategory.groupDate, 'yyyy.MM.dd(E) HH:mm')}"></div>
                </div>
            </div>
        </div>
    </section>

    <section class="container2">
        <span>ëª¨ì„ ë‚ ì§œ ì„ë°•</span>
        <div class="flex-row">
            <!-- 3 ëª¨ì„ ë‚ ì§œ ì„ë°•ìˆœ -->
            <div th:each="groupDate : ${groupByGroupDate}" th:data-group-idx="${groupDate.groupIdx}" class="card">
                <div class="card-thumb">
                    <img th:if="${groupDate.groupImgUrl != null and !#strings.isEmpty(groupDate.groupImgUrl)}"
                         th:src="@{${groupDate.groupImgUrl}}" />
                    <img th:unless="${groupDate.groupImgUrl != null and !#strings.isEmpty(groupDate.groupImgUrl)}"
                         th:src="@{/img/noImage.jpg}" />
                </div>
                <div class="card-info">
                    <div class="card-category">
                        <span th:text="${groupDate.district}"></span> Â· <span th:text="${groupDate.categoryMain.categoryMainName}"></span>
                    </div>
                    <div class="card-title" th:text="${groupDate.title}">
                    </div>
                    <div class="card-date" th:text="${#temporals.format(groupDate.groupDate, 'yyyy.MM.dd(E) HH:mm')}"></div>
                </div>
            </div>
        </div>
    </section>


    <!-- â”€â”€â”€ Footer â”€â”€â”€ -->
    <footer class="footer">
        <div class="footer-links">
            <a href="about.html" class="footer-link">íšŒì‚¬ì†Œê°œ</a><span class="footer-divider"></span>
            <a href="partnership.html" class="footer-link">ì œíœ´ì•ˆë‚´</a><span class="footer-divider"></span>
            <a href="advertising.html" class="footer-link">ê´‘ê³ ì•ˆë‚´</a><span class="footer-divider"></span>
            <a href="terms.html" class="footer-link">ì´ìš©ì•½ê´€</a><span class="footer-divider"></span>
            <a href="privacy.html" class="footer-link">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a><span class="footer-divider"></span>
            <a href="youth-policy.html" class="footer-link">ì²­ì†Œë…„ë³´í˜¸ì •ì±…</a>
        </div>
        <div class="footer-copyright">Â© 1999 â€“ 2025 dcinside. All rights reserved.</div>
    </footer>
</div>



<!-- 1. í”Œë¡œíŒ… ê°„í¸ë§¤ì¹­ ë²„íŠ¼ -->
<button id="open-filter-btn" class="fixed bottom-10 right-10 bg-white text-blue-700 border-2 border-blue-700 px-6 py-4 rounded-full font-bold shadow-xl hover:bg-blue-50 transition-all duration-300 hover:scale-105 flex items-center gap-2 z-40">
    <ion-icon name="options-outline" class="text-xl"></ion-icon>
    <span>ê°„í¸ ë§¤ì¹­</span>
</button>
<!-- 2. í•„í„° ëª¨ë‹¬ -->
<div id="filter-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50 hidden">
    <div class="filter-modal-card">
        <!-- Screen 1: Filter Settings -->
        <div id="filter-content" class="h-full flex flex-col">
            <div class="px-8 pb-4 pt-6 flex justify-between items-center">
                <h2 class="text-2xl font-bold text-gray-900">ë‚˜ì—ê²Œ ë§ëŠ” ëª¨ì„ ì°¾ê¸°</h2>
                <button id="close-filter-btn" class="w-12 h-12 rounded-full text-gray-500 hover:bg-gray-100 flex items-center justify-center">
                    <ion-icon name="close-outline" class="text-2xl"></ion-icon>
                </button>
            </div>
            <div class="filter-modal-content p-8 pt-4">
                <div class="tags-container">
                    <div class="tag-item" data-id="1"><span class="label">ìš´ë™/ì•¡í‹°ë¹„í‹°</span></div>
                    <div class="tag-item" data-id="2"><span class="label">ë¬¸í™”/ì˜ˆìˆ </span></div>
                    <div class="tag-item" data-id="3"><span class="label">ì§€ì‹/ìŠ¤í„°ë””</span></div>
                    <div class="tag-item" data-id="4"><span class="label">ìŒì‹/ì¹´í˜</span></div>
                    <div class="tag-item" data-id="5"><span class="label">ì—¬í–‰/íƒí—˜</span></div>
                    <div class="tag-item" data-id="6"><span class="label">ê²Œì„/ì˜¤ë½</span></div>
                    <div class="tag-item" data-id="7"><span class="label">ë°˜ë ¤ë™ë¬¼</span></div>
                    <div class="tag-item" data-id="8"><span class="label">ë§Œë“¤ê¸°/ê³µì˜ˆ</span></div>
                    <div class="tag-item" data-id="9"><span class="label">ì†Œì…œ/ì¹œëª©</span></div>
                </div>
                <hr class="filter-divider">
                <div class="text-center">
                    <div class="age-value"><span id="minAgeDisplay">20</span> â€“ <span id="maxAgeDisplay">50</span>ì„¸</div>
                    <div id="age-slider"></div>
                </div>
                <hr class="filter-divider">
                <div class="segmented-control">
                    <label class="seg-label"><input type="radio" name="gender" value="ëˆ„êµ¬ë‚˜" checked><span class="seg-btn">ëˆ„êµ¬ë‚˜</span></label>
                    <label class="seg-label"><input type="radio" name="gender" value="ë‚¨ìë§Œ"><span class="seg-btn">ë‚¨ìë§Œ</span></label>
                    <label class="seg-label"><input type="radio" name="gender" value="ì—¬ìë§Œ"><span class="seg-btn">ì—¬ìë§Œ</span></label>
                </div>
            </div>
            <div class="p-6 bg-gray-50 border-t">
                <button id="matchButton" class="btn-match" disabled>í•„í„° ì ìš©í•˜ê¸°</button>
            </div>
        </div>

        <!-- Screen 2: Filter Results (hidden by default) -->
        <div id="results-content" class="h-full flex flex-col hidden">
            <div class="px-8 pb-4 pt-6 flex justify-between items-center">
                <button id="back-to-filters-btn" class="w-12 h-12 rounded-full text-gray-500 hover:bg-gray-100 flex items-center justify-center">
                    <ion-icon name="arrow-back-outline" class="text-2xl"></ion-icon>
                </button>
                <h2 class="text-2xl font-bold text-gray-900">ë§¤ì¹­ëœ ëª¨ì„</h2>
                <div class="w-12 h-12"></div>
            </div>
            <div class="px-8 pb-2">
                <div id="applied-filters-display" class="flex flex-wrap items-center gap-2"></div>
            </div>
            <div class="filter-modal-content p-8 pt-4">
                <div id="results-list"></div>
            </div>
        </div>
    </div>
</div>
<!-- 3. ìƒì„¸ ëª¨ë‹¬ -->
<!-- âœ… ê·¸ë£¹ ìƒì„¸ ëª¨ë‹¬ (meetingdetail.jsê°€ ì¡°ì‘í•˜ëŠ” ëŒ€ìƒ) -->
<div id="group-detail-modal" class="fixed hidden inset-0 z-50 bg-black bg-opacity-40 flex items-center justify-center">
    <div class="bg-white rounded-xl shadow-lg w-full max-w-3xl relative overflow-y-auto max-h-[90vh]">
        <button onclick="closeGroupDetailModal()" class="absolute top-2 right-2 text-2xl text-gray-500 hover:text-black">âœ•</button>

        <section class="room-detail-section">
            <!-- ëª¨ì„ ì •ë³´ ì¹´ë“œ -->
            <div id="roomDetailCard"></div>

            <!-- âœ… ì¸ë¼ì¸ ì±„íŒ… ì˜ì—­ êµì²´ -->
            <div id="inline-chat-wrapper" style="display: none;">
                <div class="chat-container">
                    <header class="chat-header">
                        <div class="title">
                            <div class="chat-title" id="chatRoomTitleText"></div>
                        </div>
                    </header>
                    <main class="chat-messages" id="chatMessages"></main>
                    <footer class="chat-input-wrapper">
                        <div class="chat-input">
                            <button>â•</button>
                            <input type="text" id="chatInput" placeholder="ë©”ì‹œì§€ ë³´ë‚´ê¸°" />
                            <button id="sendBtn">â¤</button>
                        </div>
                    </footer>

                </div>
            </div>
        </section>

        <!-- ì‹ ê³  ëª¨ë‹¬ (ê¸°ì¡´ ë°©ì‹ ìœ ì§€) -->
        <div id="report-modal" style="display:none; position:fixed; top:20%; left:40%; background:white; padding:20px; border:1px solid #ccc; z-index:9999;">
            <h3>ğŸš¨ ë©”ì‹œì§€ ì‹ ê³ </h3>
            <label>ì‹ ê³  ì‚¬ìœ 
                <select id="report-reason">
                    <option value="1">ìš•ì„¤/ë¹„ë°©/í˜ì˜¤ í‘œí˜„</option>
                    <option value="2">ìŒë€/ì„ ì •ì ì¸ ì½˜í…ì¸ </option>
                    <option value="3">ë„ë°°/ìŠ¤íŒ¸/ê´‘ê³ </option>
                    <option value="4">ê°œì¸ ì •ë³´ ë…¸ì¶œ</option>
                    <option value="5">ì‚¬ì¹­/í—ˆìœ„ ì •ë³´</option>
                    <option value="6">ë¶€ì ì ˆí•œ ë‚´ìš©</option>
                    <option value="7">ëª¨ì„ ìš´ì˜ ë°©í•´</option>
                    <option value="8">ê¸°íƒ€</option>
                </select>
            </label><br><br>
            <textarea id="report-comment" placeholder="ì‹ ê³  ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”" rows="4" cols="40"></textarea><br><br>
            <button onclick="submitReport()">ğŸš¨ ì‹ ê³  ì œì¶œ</button>
            <button onclick="closeReportModal()">âŒ ë‹«ê¸°</button>
        </div>
    </div>
</div>

<!-- ì°¸ê°€ í™•ì¸ ëª¨ë‹¬ -->
<div id="join-confirm-modal" class="modal hidden">
    <div class="modal-dialog">
        <p class="message">
            í•´ë‹¹ ëª¨ì„ì— ì°¸ì—¬í•˜ê²Œ ë˜ë©´ ëª¨ì„ ì´ìš© íšŸìˆ˜ê°€ 1íšŒ ì°¨ê°ë©ë‹ˆë‹¤.<br>
            ì°¸ì—¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?
        </p>
        <div class="actions">
            <button id="joinConfirmBtn" class="modal-btn confirm">í™•ì¸</button>
            <button id="joinCancelBtn"  class="modal-btn cancel">ì·¨ì†Œ</button>
        </div>
    </div>
</div>

<script th:inline="javascript">
    // ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ì •ë³´ê°€ í•„ìš”í•  ë•Œ ëŒ€ë¹„
    window.currentLoggedInUser = {
      userIdx: [[${currentUser != null ? currentUser.userIdx : -1}]],
      nickname: [[${currentUser != null ? currentUser.nickname : "'ë¹„íšŒì›'"}]]
    };
</script>

<!--ê¼­ notify.jsë‚˜ notification.js ë³´ë‹¤ ìœ„ì—-->
<th:block th:replace="fragments/notification-templates :: notiTemplates"></th:block>


<script src="/js/notify.js" defer></script>
<script src="/js/notification.js" defer></script>
<script src="/js/meetingdetail.js" defer></script>
<script src="/js/filter.js" defer></script>
<script src="/js/mainHomePage.js"></script>
<script>
    $(document).ready(function () {
    const $wrapper = $('.banner-slide-wrapper');
    const slideCount = $wrapper.children().length;
    let current = 0;

    function goToSlide(index) {
      const percent = (100 / slideCount) * index;
      $wrapper.css('transform', `translateX(-${percent}%)`);
    }

    $('.banner-next').click(function () {
      current = (current + 1) % slideCount;
      goToSlide(current);
    });

    $('.banner-prev').click(function () {
      current = (current - 1 + slideCount) % slideCount;
      goToSlide(current);
    });

    goToSlide(0); // ì´ˆê¸° ìœ„ì¹˜
  });

</script>

</body>
</html>